{{ define "card" }}

{{ template "head" . }}

{{ with .Aggregator }}
<header>
  <h1>
    <a href="/{{ .Slug }}/">{{ .Name }}</a>
  </h1>
</header>
{{ end }}

<article>
  <header>
    {{ if .Card.ValidCover }}<noscript><img src="{{ .Card.Cover }}" /></noscript><img class=x data-src="{{ .Card.Cover }}">{{ end }}
    {{ if not .Card.IsPage }}
    <h1>
      <a href="/{{ .Aggregator.Slug }}/{{ .Card.Slug }}/">{{ .Card.Name }}</a>
    </h1>
    <aside>
      {{ .Card.AuthorHTML }}
      <a rel="bookmark" href="/c/{{ .Card.Id }}"><time datetime="{{ .Card.IsoDate }}">{{ .Card.PrettyDate }}</time></a>
    {{ else }}
    <aside>
    {{ end }}
      <ul>
        {{ range .Card.GetLabels }}
        <li><a rel="tag" href="/tag/{{ .SlugOrId }}/" class="{{ .Color }}">{{ .NameOrSpaces }}</a></li>
        {{ end }}
      </ul>
    </aside>
  </header>
  <div>

{{ markdown .Card.Desc}}

  </div>
</article>

{{ range .Card.GetChecklists }}
<section class="checklists">
  <header>
    <h1>{{ .Name }}</h1>
  </header>
  <ul>
    {{ range .CheckItems }}
    <li>
      <input type="checkbox" disabled {{ if .Complete }}checked{{ end }}>
      {{ markdown .Name }}
    </li>
    {{ end }}
  <ul>
</section>
{{ end }}

{{ if .Card.HasAttachments }}
<section class="attachments">
  <ul>
    {{ range .Card.GetAttachments }}
    <li><a target="_blank" href="{{ cdnurl .Url }}">{{ .Name }}</a></li>
    {{ end }}
  </ul>
</section>
{{ end }}

{{ template "foot" . }}

{{ end }}
